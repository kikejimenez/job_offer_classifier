---

title: Pipeline 

keywords: fastai
sidebar: home_sidebar

summary: "Pipeline of the text binary classifier for job offer email responses "
description: "Pipeline of the text binary classifier for job offer email responses "
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_pipeline_classifier.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The emails are classified as 'positive' or 'negative' using the Tensorflow <code>tf.estimator</code> module.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Processing">Data Processing<a class="anchor-link" href="#Data-Processing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset of email responses is loaded from a csv file.  Three steps make up the data processing pipeline:<br>
Load the data --&gt;  Make train-test split  --&gt;  Create the Tensorflow input functions</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load and split the data using the Pandas library.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_dataframe" class="doc_header"><code>split_dataframe</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_dataframe</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Split with the pandas <code>sample</code> method.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="balanced_labels_in_split" class="doc_header"><code>balanced_labels_in_split</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>balanced_labels_in_split</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Give a balanced train-test split in 'positive' and 'negative' labels</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test these function with the following example</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiments</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sentiment&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sentiment</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]}</span>
<span class="n">df_example_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">sentiments</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">)</span>
<span class="n">df_a</span> <span class="o">=</span>  <span class="n">df_example_f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># positive</span>
<span class="n">df_b</span> <span class="o">=</span> <span class="n">df_example_f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1"># negative</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
<span class="n">split_aa</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">55</span><span class="p">)</span>
<span class="n">split_bb</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">55</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">split_aa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">split_bb</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">70</span> <span class="ow">and</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">30</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">])</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span>
<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span>

<span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
<span class="n">balanced1</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">65</span><span class="p">)</span>
<span class="n">balanced2</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">65</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">balanced1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">balanced2</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Tensorflow input functions are the input elements of the Tensorflow algorithms.
These functions are created with the help of the <em>version 1</em> <code>tf.estimator,inputs</code> module</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tf_input_fn" class="doc_header"><code>tf_input_fn</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tf_input_fn</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Load a TF function for a DataFrame</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_input_fs" class="doc_header"><code>train_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_input_fs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>TF functions with parameters for training</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict_input_fs" class="doc_header"><code>predict_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict_input_fs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>TF with with parameters for testing</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load and split the dataset</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Percentage of the positive and negative sentiments</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiment_rate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="s1">&#39;sentiment: {negative: </span><span class="si">%s</span><span class="s1">, positive: </span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dataset --&gt;
sentiment: {negative: 0.10055096418732783, positive: 0.39944903581267216}
train --&gt;
sentiment: {negative: 0.10091743119266056, positive: 0.39908256880733944}
test --&gt;
sentiment: {negative: 0.1, positive: 0.4}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sample of the train dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>payload</th>
      <th>sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>64</th>
      <td>thank you very much for offering me the assist...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>170</th>
      <td>my name is pushkar patil and i am searching jo...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load Tensorflow input functions</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_input_fn</span> <span class="o">=</span> <span class="n">train_input_fs</span><span class="p">(</span><span class="n">train</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span>
<span class="n">predict_input_fn</span> <span class="o">=</span>  <span class="n">predict_input_fs</span><span class="p">(</span><span class="o">**</span><span class="n">dfs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Set-up-the-Model">Set up the Model<a class="anchor-link" href="#Set-up-the-Model"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Feature columns</em></strong></p>
<p>From TF-Hub <a href="https://github.com/tensorflow/hub/blob/master/docs/api_docs/python/hub/text_embedding_column.md">feature column</a>
we use <a href="https://tfhub.dev/google/nnlm-en-dim128/1">nnlm-en-dim128 module</a>. Some important facts are:</p>
<ul>
<li>The module takes <strong>a batch of sentences in a 1-D tensor of strings</strong> as input.</li>
<li>The module is responsible for <strong>preprocessing of sentences</strong> (e.g. removal of punctuation and splitting on spaces).</li>
<li>The module works with any input (e.g. <strong>nnlm-en-dim128</strong> hashes words not present in vocabulary into ~20.000 buckets).</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="embedded_text_feature_column_f" class="doc_header"><code>embedded_text_feature_column_f</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>embedded_text_feature_column_f</code>(<strong><code>module_spec</code></strong>=<em><code>'https://tfhub.dev/google/nnlm-en-dim128/1'</code></em>)</p>
</blockquote>
<p>Call the text embedding from the TF-Hub library</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the embedded text feature column. If it's called it for the first time, it may take time to download it (it weights around 500 MB)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">embedded_text_feature_column</span> <span class="o">=</span> <span class="n">embedded_text_feature_column_f</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Premade Estimators</em></strong></p>
<p>For classification, we use a premade <a href="https://www.tensorflow.org/api_docs/python/tf/estimator/DNNClassifier">DNN Classifier</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_estimator" class="doc_header"><code>load_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L76" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_estimator</code>(<strong><code>embedded_text_feature_column</code></strong>, <strong><code>estimator_f</code></strong>=<em><code>'DNNClassifierV2'</code></em>, <strong><code>model_dir</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Load the TF <code>estimator</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When no <em>model_dir</em> is provided, the <code>estimator</code> is stored in a temporary file. A deletion of an  <code>estimator</code> (either explicit or by the garbage collector) does not erase its corresponding directory from the disk</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>
<span class="k">del</span> <span class="n">estimator</span> 
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">rmtree</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train,-Evaluate-and-Predict">Train, Evaluate and Predict<a class="anchor-link" href="#Train,-Evaluate-and-Predict"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Train the estimator for a reasonable amount of steps.<br>
Training for 5,000 steps means 640,000 training examples with the default
batch size (128).<br>
This is roughly equivalent to 640,000/363 ~ 1700 epochs since the training dataset
contains 363 examples.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train" class="doc_header"><code>train</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train</code>(<strong><code>estimator</code></strong>, <strong><code>train_input_fn</code></strong>, <strong><code>steps</code></strong>=<em><code>5000</code></em>)</p>
</blockquote>
<p>Train with TF <code>estimator.train</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">train_input_fn</span><span class="p">,</span><span class="n">steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;train&#39;: &lt;tensorflow_estimator.python.estimator.canned.dnn.DNNClassifierV2 at 0x7f3e202ee1d0&gt;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The F1 score is not included in <code>tf.estimator.evaluate</code>. The function <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a>, calculates the F1 score from the precision and recall. The function <a href="/job_offer_classifier/pipeline_classifier#evaluate"><code>evaluate</code></a> adds to  <code>tf.estimator.evaluate</code> the  <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a> and is acting over the input functions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="f1_score" class="doc_header"><code>f1_score</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L99" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>f1_score</code>(<strong><code>estimations</code></strong>)</p>
</blockquote>
<p>Calculates function:</p>
<p><em>f1_score(precision,recall) =  (2 x precision x recall) / (precision + recall)</em></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">f1_score</span><span class="p">({</span><span class="s1">&#39;precision&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;recall&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">)})</span> <span class="o">==</span> <span class="mf">0.0</span>

<span class="k">assert</span> <span class="n">f1_score</span><span class="p">({</span><span class="s1">&#39;precision&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;recall&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>  <span class="o">==</span> <span class="mf">1.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate" class="doc_header"><code>evaluate</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L111" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate</code>(<strong><code>estimator</code></strong>, <strong>**<code>args</code></strong>:<a href="/job_offer_classifier/pipeline_classifier#tf_input_fn"><code>tf_input_fn</code></a>)</p>
</blockquote>
<p>Evaluate with TF <code>estimator.evaluate</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict" class="doc_header"><code>predict</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L121" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict</code>(<strong><code>estimator</code></strong>, <strong><code>df_examples</code></strong>)</p>
</blockquote>
<p>Predict with TF <code>estimator.predict</code> and from a dataframe of payloads.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Evaluate:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eval_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="o">**</span><span class="n">predict_input_fn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set accuracy: 0.9862385392189026
Test set accuracy: 0.9586206674575806
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1, 1, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is desirable a predictor that inputs from a string. The function <a href="/job_offer_classifier/pipeline_classifier#sentiment"><code>sentiment</code></a> covers this role.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sentiment" class="doc_header"><code>sentiment</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sentiment</code>(<strong><code>estimator</code></strong>, <strong><code>doc</code></strong>)</p>
</blockquote>
<p>Gets the sentiment of the <em>doc</em> string</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; thank you for offering me the position of Merchandiser with Thomas Ltd.</span>
<span class="s1">i am thankful to accept this job offer and look ahead to starting my career with your company</span>
<span class="s1">on June 27, 2000.&#39;&#39;&#39;</span>
<span class="n">sentiment</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">example_str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;positive&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Confusion matrix</em></strong><br>
The function <a href="/job_offer_classifier/pipeline_classifier#plot_confusion_matrix"><code>plot_confusion_matrix</code></a> plots the corresponding confusion matrix over a dataframe and its corresponding Tensorflow function. The confusion matrix helps  to understand the distribution of misclassifications.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_confusion_matrix" class="doc_header"><code>plot_confusion_matrix</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L146" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_confusion_matrix</code>(<strong><code>df_data</code></strong>, <strong><code>estimator</code></strong>, <strong><code>input_fn</code></strong>, <strong><code>header</code></strong>)</p>
</blockquote>
<p>Plot the Confusion Matrix: ${{TN,FN},{FP,TP}}$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix for the train set case</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Train data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix for the test case</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Test data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-and-Load-an-Estimator">Save and Load an Estimator<a class="anchor-link" href="#Save-and-Load-an-Estimator"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The  <a href="/job_offer_classifier/pipeline_classifier#export_estimator"><code>export_estimator</code></a> function copy the directory of the estimador given in <code>estimator.model_dir</code> to a <em>dst_model</em>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_estimator" class="doc_header"><code>export_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L169" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_estimator</code>(<strong><code>estimator</code></strong>, <strong><code>dst_estimator</code></strong>)</p>
</blockquote>
<p>Copy the estimator's directory to a new directory</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the saved estimator using <code>load_model</code> and check that the evaluation results are up to date with latest check point:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">export_estimator</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">dst_estimator</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="n">loaded_estimator_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
        <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">),</span>
        <span class="o">**</span><span class="n">predict_input_fn</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">loaded_estimator_results</span> <span class="o">==</span> <span class="n">eval_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Erase all the variables defined so far</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">df</span><span class="p">,</span><span class="n">dfs</span><span class="p">,</span> <span class="n">eval_results</span><span class="p">,</span> <span class="n">embedded_text_feature_column</span><span class="p">,</span> <span class="n">loaded_estimator_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Pipeline" class="doc_header"><code>class</code> <code>Pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L175" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Pipeline</code>(<strong><code>src_file</code></strong>, <strong><code>estimator_dir</code></strong>=<em><code>None</code></em>, <strong><code>frac</code></strong>=<em><code>0.6</code></em>, <strong><code>train_steps</code></strong>=<em><code>5000</code></em>, <strong><code>random_state</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Class that implements the previous functions as their methods.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Pipeline.__del__" class="doc_header"><code>Pipeline.__del__</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L197" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Pipeline.__del__</code>()</p>
</blockquote>
<p>Removes the <code>estimator</code> and its corresponding directory</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When an estimator is deleted, the corresponding temporary directory is kept in memory</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span> <span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
<span class="n">model_dir</span>  <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>

<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="k">del</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span>
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">rmtree</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The attribute <code>__del__</code>  in the <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> class fixes this</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span> <span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
<span class="n">model_dir</span>  <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>

<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="k">del</span> <span class="n">pl</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Pipeline.pipeline" class="doc_header"><code>Pipeline.pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L256" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Pipeline.pipeline</code>()</p>
</blockquote>
<p>The pipeline flow is:
input_fns --&gt; load_estimator --&gt; train --&gt; evaluate</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>pipeline</code> calls the functions that prepares the input data, trains the model and stores the results of the evaluation</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>After running the pipeline, check that all methods are implemented correctly</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span> <span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting evaluation is stored in <code>pipeline.evaluation</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;train&#39;, &#39;test&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;accuracy&#39;: 0.95862067,
 &#39;accuracy_baseline&#39;: 0.8,
 &#39;auc&#39;: 0.9689358,
 &#39;auc_precision_recall&#39;: 0.9912311,
 &#39;average_loss&#39;: 0.14951898,
 &#39;label/mean&#39;: 0.8,
 &#39;loss&#39;: 0.32319617,
 &#39;precision&#39;: 0.9661017,
 &#39;prediction/mean&#39;: 0.794656,
 &#39;recall&#39;: 0.98275864,
 &#39;global_step&#39;: 5000,
 &#39;f1_score&#39;: 0.9743589603123258}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confusion matrix for train set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confustion matrix for test set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that the <a href="/job_offer_classifier/pipeline_classifier#export_estimator"><code>export_estimator</code></a> is rightly copying the model files</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
    <span class="k">assert</span> <span class="n">listdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span> <span class="o">==</span> <span class="n">listdir</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict examples from dataframe in 0 1 format</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict from string</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc_str</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;thank you very much for offering me the opportunity to work at Norris, Wilson and Kelley as Clinical embryologist.</span><span class="se">\n</span><span class="s1">after much deliberation, i will not be accepting the position,</span>
<span class="s1">as it isn’t the right fit for my long-term career goals.</span><span class="se">\n</span><span class="s1">i sincerely appreciate the offer and give you</span>
<span class="s1">my best wishes in finding a suitable candidate for the position.</span><span class="se">\n</span><span class="s1">i wish you and the company well </span>
<span class="s1">in all future endeavours.&#39;&#39;&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">sentiment</span><span class="p">(</span><span class="n">doc_str</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>negative
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create an instance of a <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> and run it (call <code>pipeline</code> method). Export the <code>estimator</code>. 
Create a new instance of a <code>pipeline</code> with the exported <code>estimator</code>. Evaluate in this pipeline without training.
The resulting evaluations of the two pipelines must coincide, provided that the <code>evaluation</code> is carried out in the same test set [CAVEAT: They must coincide up to a factor (see below)].</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pl1</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">pl1</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
    <span class="n">pl1</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">dst_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="n">pl2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">,</span><span class="n">estimator_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">input_fns</span><span class="p">()</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
    
<span class="k">assert</span>  <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">==</span>  <span class="n">pl2</span><span class="o">.</span><span class="n">evaluation</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instantiate the Pipeline class twice with the same seed</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;src_file&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/interim/payloads.csv&#39;</span>
<span class="p">}</span>
<span class="n">pl1</span><span class="p">,</span> <span class="n">pl2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">Pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">pl1</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
<span class="n">pl2</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the seed is the same from both pipelines, the train/test split is the same in both cases</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">pl1</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">pl2</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">pl1</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">pl2</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Tensorflow training algorithms are not completely <a href="https://github.com/NVIDIA/tensorflow-determinism"><em>deterministic</em></a>. Therefore, the scores in the two pipelines are equal up to a factor. Calculate that factor.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; $error  = m 10^{-n}$</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
        <span class="nb">abs</span><span class="p">(</span>
            <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">dataname</span><span class="p">][</span><span class="n">scorename</span><span class="p">]</span> <span class="o">-</span>
            <span class="n">pl2</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">dataname</span><span class="p">][</span><span class="n">scorename</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataname</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">scorename</span> <span class="ow">in</span> <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">):</span>
    <span class="k">if</span> <span class="n">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">break</span>
        
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The scores with different instances of the pipeline class are equal up to a factor of </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1"> x 10^(</span><span class="si">{</span><span class="o">-</span><span class="n">n</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span> 

<span class="k">assert</span> <span class="n">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The scores with different instances of the pipeline class are equal up to a factor of 9 x 10^(-3)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

