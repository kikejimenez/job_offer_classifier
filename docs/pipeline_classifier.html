---

title: Pipeline 

keywords: fastai
sidebar: home_sidebar

summary: "The pipeline of text binary classifier for job offer email responses "
description: "The pipeline of text binary classifier for job offer email responses "
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_pipeline_classifier.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset of email responses is loaded from a csv file. The data is classified as 'positive' or 'negative' using Tensorflow <code>tf.estimator</code> module.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Processing">Data Processing<a class="anchor-link" href="#Data-Processing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have three steps in the data processing pipeline:</p>
<ul>
<li>load data --&gt;  train-test split  --&gt;  TF input functions</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The loading and train-test split is done using the Pandas library. The conversion from a dataframe to a TF function is  necessary.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_dataframe" class="doc_header"><code>split_dataframe</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_dataframe</code>(<strong><code>df</code></strong>, <strong>**<code>args</code></strong>)</p>
</blockquote>
<p>split with pandas sample(...) method. default args: frac=None, random_state=None,...</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="concat_and_shuffle" class="doc_header"><code>concat_and_shuffle</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L28" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>concat_and_shuffle</code>(<strong><code>train</code></strong>, <strong><code>test</code></strong>, <strong>**<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="balanced_labels_in_split" class="doc_header"><code>balanced_labels_in_split</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L32" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>balanced_labels_in_split</code>(<strong><code>df</code></strong>, <strong>**<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test the split function with the following example</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiments</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sentiment&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sentiment</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]}</span>
<span class="n">df_example_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">sentiments</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">)</span>
<span class="n">df_a</span> <span class="o">=</span>  <span class="n">df_example_f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># positive</span>
<span class="n">df_b</span> <span class="o">=</span> <span class="n">df_example_f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1"># negative</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">70</span> <span class="ow">and</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">30</span> 

<span class="k">assert</span> <span class="n">concat_and_shuffle</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">df_a</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">df_b</span><span class="o">.</span><span class="n">size</span>

<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span>
    <span class="n">concat_and_shuffle</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="o">.</span><span class="n">sentiment</span><span class="o">.</span><span class="n">values</span> <span class="o">!=</span>
    <span class="n">concat_and_shuffle</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">sentiment</span><span class="o">.</span><span class="n">values</span>
<span class="p">)</span> 

<span class="n">dataset</span> <span class="o">=</span> <span class="n">concat_and_shuffle</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">)</span>

<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">frac</span> <span class="o">=</span> <span class="o">.</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span>

<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span>  
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Tensorflow input functions for train, test and example datasets are created with the help of v1 tf.estimator library</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tf_input_fn" class="doc_header"><code>tf_input_fn</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tf_input_fn</code>(<strong><code>df</code></strong>, <strong><code>shuffle</code></strong>=<em><code>False</code></em>, <strong>**<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_input_fs" class="doc_header"><code>train_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L47" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_input_fs</code>(<strong>**<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict_input_fs" class="doc_header"><code>predict_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L53" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict_input_fs</code>(<strong>**<code>args</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load and split the dataset</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Percentage of the positive and negative sentiments</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiment_rate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="s1">&#39;sentiment: {negative: </span><span class="si">%s</span><span class="s1">, positive: </span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dataset --&gt;
sentiment: {negative: 0.10055096418732783, positive: 0.39944903581267216}
train --&gt;
sentiment: {negative: 0.10091743119266056, positive: 0.39908256880733944}
test --&gt;
sentiment: {negative: 0.1, positive: 0.4}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sample of the train dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>payload</th>
      <th>sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>170</th>
      <td>my name is pushkar patil and i am searching jo...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>30</th>
      <td>following our recent conversation, i want to t...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load Tensorflow input functions</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_input_fn</span> <span class="o">=</span> <span class="n">train_input_fs</span><span class="p">(</span><span class="n">train</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span>
<span class="n">predict_input_fn</span> <span class="o">=</span>  <span class="n">predict_input_fs</span><span class="p">(</span><span class="o">**</span><span class="n">dfs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Set-up-the-Model">Set up the Model<a class="anchor-link" href="#Set-up-the-Model"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Feature columns</em></strong></p>
<p>From TF-Hub <a href="https://github.com/tensorflow/hub/blob/master/docs/api_docs/python/hub/text_embedding_column.md">feature column</a>
we use <a href="https://tfhub.dev/google/nnlm-en-dim128/1">nnlm-en-dim128 module</a>. Some important facts are:</p>
<ul>
<li>The module takes <strong>a batch of sentences in a 1-D tensor of strings</strong> as input.</li>
<li>The module is responsible for <strong>preprocessing of sentences</strong> (e.g. removal of punctuation and splitting on spaces).</li>
<li>The module works with any input (e.g. <strong>nnlm-en-dim128</strong> hashes words not present in vocabulary into ~20.000 buckets).</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="embedded_text_feature_column_f" class="doc_header"><code>embedded_text_feature_column_f</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>embedded_text_feature_column_f</code>(<strong><code>module_spec</code></strong>=<em><code>'https://tfhub.dev/google/nnlm-en-dim128/1'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the embedded text feature column. If it's called it for the first time, it may take time to download it (it weights around 500 MB)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">embedded_text_feature_column</span> <span class="o">=</span> <span class="n">embedded_text_feature_column_f</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Premade Estimators</em></strong></p>
<p>For classification, we use a premade <a href="https://www.tensorflow.org/api_docs/python/tf/estimator/DNNClassifier">DNN Classifier</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_estimator" class="doc_header"><code>load_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L65" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_estimator</code>(<strong><code>embedded_text_feature_column</code></strong>, <strong><code>estimator</code></strong>=<em><code>'DNNClassifierV2'</code></em>, <strong><code>model_dir</code></strong>=<em><code>None</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The estimator is stored in a temporary file and will be erased unless explicitly exported it (see <a href="/job_offer_classifier/pipeline_classifier#export_estimator"><code>export_estimator</code></a> function).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train,-Evaluate-and-Predict">Train, Evaluate and Predict<a class="anchor-link" href="#Train,-Evaluate-and-Predict"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Train the estimator for a reasonable amount of steps.<br>
 Training for 5,000 steps means 640,000 training examples with the default
 batch size (128).<br>
 This is roughly equivalent to 640,000/363 ~ 1700 epochs since the training dataset
 contains 363 examples.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train" class="doc_header"><code>train</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L77" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train</code>(<strong><code>estimator</code></strong>, <strong><code>train_input_fn</code></strong>, <strong><code>steps</code></strong>=<em><code>5000</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">train_input_fn</span><span class="p">,</span><span class="n">steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;train&#39;: &lt;tensorflow_estimator.python.estimator.canned.dnn.DNNClassifierV2 at 0x7f06c20413d0&gt;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The F1 score is not included in <code>tf.estimator.evaluate</code>. The function <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a>, calculates the F1 score from the precision and recall. The function <a href="/job_offer_classifier/pipeline_classifier#evaluate"><code>evaluate</code></a> adds to  <code>tf.estimator.evaluate</code> the  <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a> and is acting over the input functions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="f1_score" class="doc_header"><code>f1_score</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L84" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>f1_score</code>(<strong><code>estimations</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate" class="doc_header"><code>evaluate</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate</code>(<strong><code>estimator</code></strong>, <strong>**<code>args</code></strong>:<a href="/job_offer_classifier/pipeline_classifier#tf_input_fn"><code>tf_input_fn</code></a>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <a href="/job_offer_classifier/pipeline_classifier#predict"><code>predict</code></a> function, takes a dataframe of payloads in give the corresponding prediction</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict" class="doc_header"><code>predict</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L98" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict</code>(<strong><code>estimator</code></strong>, <strong><code>df_examples</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Evaluate:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eval_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="o">**</span><span class="n">predict_input_fn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set accuracy: 0.9862385392189026
Test set accuracy: 0.9448275566101074
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 0, 1, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is desirable a function that takes directly a string and assesses if it represents a  positive or negative sentiment. The function <a href="/job_offer_classifier/pipeline_classifier#sentiment"><code>sentiment</code></a> covers this role.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sentiment" class="doc_header"><code>sentiment</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L113" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sentiment</code>(<strong><code>estimator</code></strong>, <strong><code>doc</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; thank you for offering me the position of Merchandiser with Thomas Ltd.</span>
<span class="s1">i am thankful to accept this job offer and look ahead to starting my career with your company</span>
<span class="s1">on June 27, 2000.&#39;&#39;&#39;</span>
<span class="n">sentiment</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">example_str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;positive&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Confusion matrix</em></strong><br>
The function <a href="/job_offer_classifier/pipeline_classifier#plot_confusion_matrix"><code>plot_confusion_matrix</code></a> plots the corresponding confusion matrix over dataframe and its corresponding TF function. Confusion matrix helps  to understand the distribution of misclassifications.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_confusion_matrix" class="doc_header"><code>plot_confusion_matrix</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L119" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_confusion_matrix</code>(<strong><code>df_data</code></strong>, <strong><code>estimator</code></strong>, <strong><code>input_fn</code></strong>, <strong><code>header</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix on the Train Set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Train data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix on the Test Set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Test data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-and-Load-an-Estimator">Save and Load an Estimator<a class="anchor-link" href="#Save-and-Load-an-Estimator"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="The--export_estimator-function-copy-the-directory-of-the-estimador-given-in-estimator.model_dir-to-a-dst_model.">The  <a href="/job_offer_classifier/pipeline_classifier#export_estimator"><code>export_estimator</code></a> function copy the directory of the estimador given in <code>estimator.model_dir</code> to a <em>dst_model</em>.<a class="anchor-link" href="#The--export_estimator-function-copy-the-directory-of-the-estimador-given-in-estimator.model_dir-to-a-dst_model."> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_estimator" class="doc_header"><code>export_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L140" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_estimator</code>(<strong><code>estimator</code></strong>, <strong><code>dst_estimator</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the saved estimator using <code>load_model</code> and check that the evaluation results are up to date with latest check point:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">export_estimator</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">dst_estimator</span> <span class="o">=</span> <span class="n">tmp_dir</span><span class="p">)</span>
    <span class="n">loaded_estimator_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">,</span><span class="n">model_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">),</span><span class="o">**</span><span class="n">predict_input_fn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">loaded_estimator_results</span> <span class="o">==</span> <span class="n">eval_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">df</span><span class="p">,</span><span class="n">dfs</span><span class="p">,</span><span class="n">estimator</span><span class="p">,</span> <span class="n">eval_results</span><span class="p">,</span> <span class="n">embedded_text_feature_column</span><span class="p">,</span> <span class="n">loaded_estimator_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Pipeline" class="doc_header"><code>class</code> <code>Pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L144" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Pipeline</code>(<strong><code>src_file</code></strong>, <strong><code>estimator_dir</code></strong>=<em><code>None</code></em>, <strong><code>frac</code></strong>=<em><code>0.6</code></em>)</p>
</blockquote>
<p>Class that implements the previous functions as their methods and has a new addtional method <code>pipeline</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>pipeline</code> calls the functions that prepares the input data, trains the model and stores the results of the evaluation</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Pipeline.pipeline" class="doc_header"><code>Pipeline.pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Pipeline.pipeline</code>()</p>
</blockquote>
<p>The pipeline flow is:
input_fns --&gt; load_estimator --&gt; train --&gt; evaluate</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Check that all methods are implemented correctly</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>First call the pipeline method</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span> <span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting evaluation is stored in <code>pipeline.evaluation</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;train&#39;, &#39;test&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;accuracy&#39;: 0.93793106,
 &#39;accuracy_baseline&#39;: 0.8,
 &#39;auc&#39;: 0.973692,
 &#39;auc_precision_recall&#39;: 0.992946,
 &#39;average_loss&#39;: 0.15406965,
 &#39;label/mean&#39;: 0.8,
 &#39;loss&#39;: 0.104880035,
 &#39;precision&#39;: 0.9652174,
 &#39;prediction/mean&#39;: 0.79799306,
 &#39;recall&#39;: 0.95689654,
 &#39;global_step&#39;: 5000,
 &#39;f1_score&#39;: 0.9610389967139518}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confusion matrix for train set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confustion matrix for test set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that the <a href="/job_offer_classifier/pipeline_classifier#export_estimator"><code>export_estimator</code></a> is rightly copying the model files</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
    <span class="k">assert</span> <span class="n">listdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span> <span class="o">==</span> <span class="n">listdir</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict examples from dataframe in 0 1 format</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict from string</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc_str</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;thank you very much for offering me the opportunity to work at Norris, Wilson and Kelley as Clinical embryologist.</span><span class="se">\n</span><span class="s1">after much deliberation, i will not be accepting the position,</span>
<span class="s1">as it isnt the right fit for my long-term career goals.</span><span class="se">\n</span><span class="s1">i sincerely appreciate the offer and give you</span>
<span class="s1">my best wishes in finding a suitable candidate for the position.</span><span class="se">\n</span><span class="s1">i wish you and the company well </span>
<span class="s1">in all future endeavours.&#39;&#39;&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">sentiment</span><span class="p">(</span><span class="n">doc_str</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>negative
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

