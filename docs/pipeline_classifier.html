---

title: Pipeline 

keywords: fastai
sidebar: home_sidebar

summary: "Pipeline of the text binary classifier for job offer email responses "
description: "Pipeline of the text binary classifier for job offer email responses "
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_pipeline_classifier.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The emails are classified as 'positive' or 'negative' using the Tensorflow <code>tf.estimator</code> module.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Processing">Data Processing<a class="anchor-link" href="#Data-Processing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset of email responses is loaded from a csv file.  Three steps make up the data processing pipeline:<br>
Load the data --&gt;  Make train-test split  --&gt;  Create the Tensorflow input functions</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load and split the data using the Pandas library.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_dataframe" class="doc_header"><code>split_dataframe</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_dataframe</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Split with the pandas <code>sample</code> method.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="balanced_labels_in_split" class="doc_header"><code>balanced_labels_in_split</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>balanced_labels_in_split</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Give a balanced train-test split in 'positive' and 'negative' labels</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test these function with the following example</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiments</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sentiment&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sentiment</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]}</span>
<span class="n">df_example_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">sentiments</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">)</span>
<span class="n">df_a</span> <span class="o">=</span>  <span class="n">df_example_f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># positive</span>
<span class="n">df_b</span> <span class="o">=</span> <span class="n">df_example_f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1"># negative</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
<span class="n">split_aa</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">55</span><span class="p">)</span>
<span class="n">split_bb</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">55</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">split_aa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">split_bb</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">70</span> <span class="ow">and</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">30</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">])</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span>
<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span>

<span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
<span class="n">balanced1</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">65</span><span class="p">)</span>
<span class="n">balanced2</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">65</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">balanced1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">balanced2</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Tensorflow input functions are the input elements of the Tensorflow algorithms.
These functions are created with the help of the <em>version 1</em> <code>tf.estimator,inputs</code> module</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tf_input_fn" class="doc_header"><code>tf_input_fn</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tf_input_fn</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Load a TF function for a DataFrame</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_input_fs" class="doc_header"><code>train_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_input_fs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>TF functions with parameters for training</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict_input_fs" class="doc_header"><code>predict_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict_input_fs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>TF with with parameters for testing</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load and split the dataset</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Percentage of the positive and negative sentiments</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiment_rate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="s1">&#39;sentiment: {negative: </span><span class="si">%s</span><span class="s1">, positive: </span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dataset --&gt;
sentiment: {negative: 0.10055096418732783, positive: 0.39944903581267216}
train --&gt;
sentiment: {negative: 0.10091743119266056, positive: 0.39908256880733944}
test --&gt;
sentiment: {negative: 0.1, positive: 0.4}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sample of the train dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>payload</th>
      <th>sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>168</th>
      <td>i have attached my profile.\nkindly let me kno...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>254</th>
      <td>as per email notification, i am sending my res...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load Tensorflow input functions</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_input_fn</span> <span class="o">=</span> <span class="n">train_input_fs</span><span class="p">(</span><span class="n">train</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span>
<span class="n">predict_input_fn</span> <span class="o">=</span>  <span class="n">predict_input_fs</span><span class="p">(</span><span class="o">**</span><span class="n">dfs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Set-up-the-Model">Set up the Model<a class="anchor-link" href="#Set-up-the-Model"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Feature columns</em></strong></p>
<p>From TF-Hub <a href="https://github.com/tensorflow/hub/blob/master/docs/api_docs/python/hub/text_embedding_column.md">feature column</a>
we use <a href="https://tfhub.dev/google/nnlm-en-dim128/1">nnlm-en-dim128 module</a>. Some important facts are:</p>
<ul>
<li>The module takes <strong>a batch of sentences in a 1-D tensor of strings</strong> as input.</li>
<li>The module is responsible for <strong>preprocessing of sentences</strong> (e.g. removal of punctuation and splitting on spaces).</li>
<li>The module works with any input (e.g. <strong>nnlm-en-dim128</strong> hashes words not present in vocabulary into ~20.000 buckets).</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="embedded_text_feature_column_f" class="doc_header"><code>embedded_text_feature_column_f</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>embedded_text_feature_column_f</code>(<strong><code>module_spec</code></strong>=<em><code>'https://tfhub.dev/google/nnlm-en-dim128/1'</code></em>)</p>
</blockquote>
<p>Call the text embedding from the TF-Hub library</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the embedded text feature column. If it's called it for the first time, it may take time to download it (it weights around 500 MB)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">embedded_text_feature_column</span> <span class="o">=</span> <span class="n">embedded_text_feature_column_f</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Premade Estimators</em></strong></p>
<p>For classification, we use a premade <a href="https://www.tensorflow.org/api_docs/python/tf/estimator/DNNClassifier">DNN Classifier</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_estimator" class="doc_header"><code>load_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L76" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_estimator</code>(<strong><code>embedded_text_feature_column</code></strong>, <strong><code>estimator_f</code></strong>=<em><code>'DNNClassifierV2'</code></em>, <strong><code>model_dir</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Load the TF <code>estimator</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When no <em>model_dir</em> is provided, the <code>estimator</code> is stored in a temporary file. A deletion of an  <code>estimator</code> (either explicit or by the garbage collector) does not erase its corresponding directory from the disk</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>
<span class="k">del</span> <span class="n">estimator</span> 
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">rmtree</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train,-Evaluate-and-Predict">Train, Evaluate and Predict<a class="anchor-link" href="#Train,-Evaluate-and-Predict"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Train the estimator for a reasonable amount of steps.<br>
Training for 5,000 steps means 640,000 training examples with the default
batch size (128).<br>
This is roughly equivalent to 640,000/363 ~ 1700 epochs since the training dataset
contains 363 examples.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train" class="doc_header"><code>train</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train</code>(<strong><code>estimator</code></strong>, <strong><code>train_input_fn</code></strong>, <strong><code>steps</code></strong>=<em><code>5000</code></em>)</p>
</blockquote>
<p>Train with TF <code>estimator.train</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">train_input_fn</span><span class="p">,</span><span class="n">steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;train&#39;: &lt;tensorflow_estimator.python.estimator.canned.dnn.DNNClassifierV2 at 0x7fc2629e5250&gt;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The F1 score is not included in <code>tf.estimator.evaluate</code>. The function <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a>, calculates the F1 score from the precision and recall. The function <a href="/job_offer_classifier/pipeline_classifier#evaluate"><code>evaluate</code></a> adds to  <code>tf.estimator.evaluate</code> the  <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a> and is acting over the input functions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="f1_score" class="doc_header"><code>f1_score</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L99" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>f1_score</code>(<strong><code>estimations</code></strong>)</p>
</blockquote>
<p>Calculates function:</p>
<p><em>f1_score(precision,recall) =  (2 x precision x recall) / (precision + recall)</em></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">f1_score</span><span class="p">({</span><span class="s1">&#39;precision&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;recall&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">)})</span> <span class="o">==</span> <span class="mf">0.0</span>

<span class="k">assert</span> <span class="n">f1_score</span><span class="p">({</span><span class="s1">&#39;precision&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;recall&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>  <span class="o">==</span> <span class="mf">1.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate" class="doc_header"><code>evaluate</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L111" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate</code>(<strong><code>estimator</code></strong>, <strong>**<code>args</code></strong>:<a href="/job_offer_classifier/pipeline_classifier#tf_input_fn"><code>tf_input_fn</code></a>)</p>
</blockquote>
<p>Evaluate with TF <code>estimator.evaluate</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict" class="doc_header"><code>predict</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L121" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict</code>(<strong><code>estimator</code></strong>, <strong><code>df_examples</code></strong>)</p>
</blockquote>
<p>Predict with TF <code>estimator.predict</code> and from a dataframe of payloads.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Evaluate:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eval_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="o">**</span><span class="n">predict_input_fn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set accuracy: 0.9862385392189026
Test set accuracy: 0.9724137783050537
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1, 0, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is desirable a predictor that inputs from a string. The function <a href="/job_offer_classifier/pipeline_classifier#sentiment"><code>sentiment</code></a> covers this role.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sentiment" class="doc_header"><code>sentiment</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sentiment</code>(<strong><code>estimator</code></strong>, <strong><code>doc</code></strong>)</p>
</blockquote>
<p>Gets the sentiment of the <em>doc</em> string</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; thank you for offering me the position of Merchandiser with Thomas Ltd.</span>
<span class="s1">i am thankful to accept this job offer and look ahead to starting my career with your company</span>
<span class="s1">on June 27, 2000.&#39;&#39;&#39;</span>
<span class="n">sentiment</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">example_str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;positive&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Confusion matrix</em></strong><br>
The function <a href="/job_offer_classifier/pipeline_classifier#plot_confusion_matrix"><code>plot_confusion_matrix</code></a> plots the corresponding confusion matrix over a dataframe and its corresponding Tensorflow function. The confusion matrix helps  to understand the distribution of misclassifications.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_confusion_matrix" class="doc_header"><code>plot_confusion_matrix</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L146" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_confusion_matrix</code>(<strong><code>df_data</code></strong>, <strong><code>estimator</code></strong>, <strong><code>input_fn</code></strong>, <strong><code>header</code></strong>)</p>
</blockquote>
<p>Plot the Confusion Matrix: ${{TN,FN},{FP,TP}}$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix for the train set case</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Train data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix for the test case</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Test data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-and-Load-an-Estimator">Save and Load an Estimator<a class="anchor-link" href="#Save-and-Load-an-Estimator"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The  <a href="/job_offer_classifier/pipeline_classifier#export_estimator"><code>export_estimator</code></a> function copy the directory of the estimador given in <code>estimator.model_dir</code> to a <em>dst_model</em>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_estimator" class="doc_header"><code>export_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L169" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_estimator</code>(<strong><code>estimator</code></strong>, <strong><code>dst_estimator</code></strong>)</p>
</blockquote>
<p>Copy the estimator's directory to a new directory</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the saved estimator using <code>load_model</code> and check that the evaluation results are up to date with latest check point:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">export_estimator</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">dst_estimator</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="n">loaded_estimator_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
        <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">),</span>
        <span class="o">**</span><span class="n">predict_input_fn</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">loaded_estimator_results</span> <span class="o">==</span> <span class="n">eval_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Erase all the variables defined so far</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">df</span><span class="p">,</span><span class="n">dfs</span><span class="p">,</span> <span class="n">eval_results</span><span class="p">,</span> <span class="n">embedded_text_feature_column</span><span class="p">,</span> <span class="n">loaded_estimator_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Pipeline" class="doc_header"><code>class</code> <code>Pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L175" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Pipeline</code>(<strong><code>src_file</code></strong>=<em><code>None</code></em>, <strong><code>estimator_dir</code></strong>=<em><code>None</code></em>, <strong><code>frac</code></strong>=<em><code>0.6</code></em>, <strong><code>train_steps</code></strong>=<em><code>5000</code></em>, <strong><code>random_state</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Implements the workflow: Load -&gt; Train -&gt; Evaluate.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Pipeline.__del__" class="doc_header"><code>Pipeline.__del__</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L199" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Pipeline.__del__</code>()</p>
</blockquote>
<p>Removes the <code>estimator</code> and its corresponding directory,
unless the estimator_dir is None.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When an estimator is deleted, the corresponding temporary directory is kept in memory</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span> <span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
<span class="n">model_dir</span>  <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>

<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="k">del</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span>
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">rmtree</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The attribute <code>__del__</code>  in the <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> class fixes this</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
<span class="n">model_dir</span>  <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>

<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="k">del</span> <span class="n">pl</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The deletion of the <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> instance does not cause the deletion of the estimator directory when the estimator has been previously loaded (specifying it in <em>estimator_dir</em>).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">()</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
    <span class="n">model_dir</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">dst_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">pl</span>
    
    <span class="k">assert</span> <span class="n">tmp_dir</span> <span class="o">!=</span> <span class="n">model_dir</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span> 
    <span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
    <span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">estimator_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">pl</span> 
    
    <span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Pipeline.pipeline" class="doc_header"><code>Pipeline.pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L253" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Pipeline.pipeline</code>()</p>
</blockquote>
<p>The pipeline flow is:
input_fns --&gt; load_estimator --&gt; train --&gt; evaluate</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>pipeline</code> calls the functions that prepares the input data, trains the model and stores the results of the evaluation</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>After running the pipeline, check that all methods are implemented correctly</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span> <span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting evaluation is stored in <code>pipeline.evaluation</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;train&#39;, &#39;test&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;accuracy&#39;: 0.95862067,
 &#39;accuracy_baseline&#39;: 0.8,
 &#39;auc&#39;: 0.9861772,
 &#39;auc_precision_recall&#39;: 0.996415,
 &#39;average_loss&#39;: 0.12233619,
 &#39;label/mean&#39;: 0.8,
 &#39;loss&#39;: 0.233802,
 &#39;precision&#39;: 0.9583333,
 &#39;prediction/mean&#39;: 0.8161914,
 &#39;recall&#39;: 0.9913793,
 &#39;global_step&#39;: 5000,
 &#39;f1_score&#39;: 0.9745762658783566}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confusion matrix for train set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confustion matrix for test set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that the <a href="/job_offer_classifier/pipeline_classifier#export_estimator"><code>export_estimator</code></a> is rightly copying the model files</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
    <span class="k">assert</span> <span class="n">listdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span> <span class="o">==</span> <span class="n">listdir</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict examples from dataframe in 0 1 format</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict from string</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc_str</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;thank you very much for offering me the opportunity to work at Norris, Wilson and Kelley as Clinical embryologist.</span><span class="se">\n</span><span class="s1">after much deliberation, i will not be accepting the position,</span>
<span class="s1">as it isnt the right fit for my long-term career goals.</span><span class="se">\n</span><span class="s1">i sincerely appreciate the offer and give you</span>
<span class="s1">my best wishes in finding a suitable candidate for the position.</span><span class="se">\n</span><span class="s1">i wish you and the company well </span>
<span class="s1">in all future endeavours.&#39;&#39;&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">sentiment</span><span class="p">(</span><span class="n">doc_str</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>negative
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create an instance of a <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> and run it (call <code>pipeline</code> method). Export the <code>estimator</code>. 
Create a new instance of a <code>pipeline</code> with the exported <code>estimator</code>. Evaluate in this pipeline without training.
The resulting evaluations of the two pipelines must coincide, provided that the <code>evaluation</code> is carried out in the same test set [CAVEAT: They must coincide up to a factor (see below)].</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pl1</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">pl1</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
    <span class="n">pl1</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">dst_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="n">pl2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">,</span><span class="n">estimator_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">input_fns</span><span class="p">()</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
    
<span class="k">assert</span>  <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">==</span>  <span class="n">pl2</span><span class="o">.</span><span class="n">evaluation</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instantiate the Pipeline class twice with the same seed</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;src_file&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/interim/payloads.csv&#39;</span>
<span class="p">}</span>
<span class="n">pl1</span><span class="p">,</span> <span class="n">pl2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">Pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">pl1</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
<span class="n">pl2</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the seed is the same from both pipelines, the train/test split is the same in both cases</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">pl1</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">pl2</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">pl1</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">pl2</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Tensorflow training algorithms are not completely <a href="https://github.com/NVIDIA/tensorflow-determinism"><em>deterministic</em></a>. Therefore, the scores in the two pipelines are equal up to a factor. Calculate that factor.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; $error  = m 10^{-n}$</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
        <span class="nb">abs</span><span class="p">(</span>
            <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">dataname</span><span class="p">][</span><span class="n">scorename</span><span class="p">]</span> <span class="o">-</span>
            <span class="n">pl2</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">dataname</span><span class="p">][</span><span class="n">scorename</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataname</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">scorename</span> <span class="ow">in</span> <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">):</span>
    <span class="k">if</span> <span class="n">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">break</span>
        
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The scores with different instances of the pipeline class are equal up to a factor of </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1"> x 10^(</span><span class="si">{</span><span class="o">-</span><span class="n">n</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span> 

<span class="k">assert</span> <span class="n">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The scores with different instances of the pipeline class are equal up to a factor of 3 x 10^(-2)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

