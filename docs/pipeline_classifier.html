---

title: Pipeline 

keywords: fastai
sidebar: home_sidebar

summary: "Pipeline of the text binary classifier for job offer email responses "
description: "Pipeline of the text binary classifier for job offer email responses "
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/01_pipeline_classifier.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The emails are classified as 'positive' or 'negative' using the Tensorflow <code>tf.estimator</code> module.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Processing">Data Processing<a class="anchor-link" href="#Data-Processing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset of email responses is loaded from a csv file.  Three steps make up the data processing pipeline:<br>
Load the data --&gt;  Make train-test split  --&gt;  Create the Tensorflow input functions</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load and split the data using the Pandas library.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="split_dataframe" class="doc_header"><code>split_dataframe</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L25" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>split_dataframe</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Split with the pandas <code>sample</code> method.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="balanced_labels_in_split" class="doc_header"><code>balanced_labels_in_split</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>balanced_labels_in_split</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Give a balanced train-test split in 'positive' and 'negative' labels</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test these function with the following example</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiments</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sentiment&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sentiment</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]}</span>
<span class="n">df_example_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">sentiments</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">)</span>
<span class="n">df_a</span> <span class="o">=</span>  <span class="n">df_example_f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># positive</span>
<span class="n">df_b</span> <span class="o">=</span> <span class="n">df_example_f</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">200</span><span class="p">)</span> <span class="c1"># negative</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
<span class="n">split_aa</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">55</span><span class="p">)</span>
<span class="n">split_bb</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">55</span><span class="p">)</span>

<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">split_aa</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">split_bb</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">split_dataframe</span><span class="p">(</span><span class="n">df_a</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">70</span> <span class="ow">and</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">30</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_a</span><span class="p">,</span> <span class="n">df_b</span><span class="p">])</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">+</span> <span class="n">test</span><span class="o">.</span><span class="n">size</span>
<span class="k">assert</span> <span class="n">train</span><span class="o">.</span><span class="n">size</span> <span class="o">/</span> <span class="n">dataset</span><span class="o">.</span><span class="n">size</span>

<span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="p">)</span>
<span class="n">balanced1</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">65</span><span class="p">)</span>
<span class="n">balanced2</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">,</span> <span class="n">frac</span><span class="o">=.</span><span class="mi">65</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">balanced1</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">balanced2</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Tensorflow input functions are the input elements of the Tensorflow algorithms.
These functions are created with the help of the <em>version 1</em> <code>tf.estimator,inputs</code> module</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="tf_input_fn" class="doc_header"><code>tf_input_fn</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>tf_input_fn</code>(<strong><code>df</code></strong>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Load a TF function for a DataFrame</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train_input_fs" class="doc_header"><code>train_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L52" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train_input_fs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>TF functions with parameters for training</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict_input_fs" class="doc_header"><code>predict_input_fs</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L60" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict_input_fs</code>(<strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>TF with parameters for testing</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load and split the dataset</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;sentiment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sentiment</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;positive&#39;</span><span class="p">))</span>
<span class="n">dfs</span> <span class="o">=</span> <span class="n">balanced_labels_in_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">frac</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Percentage of the positive and negative sentiments</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiment_rate</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">df</span><span class="p">:</span> <span class="s1">&#39;sentiment: {negative: </span><span class="si">%s</span><span class="s1">, positive: </span><span class="si">%s</span><span class="s1">}&#39;</span> <span class="o">%</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span><span class="p">,</span>
    <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">sentiment</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">df</span><span class="o">.</span><span class="n">size</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;dataset --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;train --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;test --&gt;&#39;</span><span class="p">,</span><span class="n">sentiment_rate</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]),</span><span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>dataset --&gt;
sentiment: {negative: 0.10055096418732783, positive: 0.39944903581267216}
train --&gt;
sentiment: {negative: 0.10091743119266056, positive: 0.39908256880733944}
test --&gt;
sentiment: {negative: 0.1, positive: 0.4}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sample of the train dataset</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>payload</th>
      <th>sentiment</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>187</th>
      <td>i am writing this email to enquire as to wheth...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>124</th>
      <td>i am sending you my resume for the position of...</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Load Tensorflow input functions</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train_input_fn</span> <span class="o">=</span> <span class="n">train_input_fs</span><span class="p">(</span><span class="n">train</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span>
<span class="n">predict_input_fn</span> <span class="o">=</span>  <span class="n">predict_input_fs</span><span class="p">(</span><span class="o">**</span><span class="n">dfs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Set-up-the-Model">Set up the Model<a class="anchor-link" href="#Set-up-the-Model"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Feature columns</em></strong></p>
<p>From TF-Hub <a href="https://github.com/tensorflow/hub/blob/master/docs/api_docs/python/hub/text_embedding_column.md">feature column</a>
we use <a href="https://tfhub.dev/google/nnlm-en-dim128/1">nnlm-en-dim128 module</a>. Some important facts are:</p>
<ul>
<li>The module takes <strong>a batch of sentences in a 1-D tensor of strings</strong> as input.</li>
<li>The module is responsible for <strong>preprocessing of sentences</strong> (e.g. removal of punctuation and splitting on spaces).</li>
<li>The module works with any input (e.g. <strong>nnlm-en-dim128</strong> hashes words not present in vocabulary into ~20.000 buckets).</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="embedded_text_feature_column_f" class="doc_header"><code>embedded_text_feature_column_f</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L68" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>embedded_text_feature_column_f</code>(<strong><code>module_spec</code></strong>=<em><code>'https://tfhub.dev/google/nnlm-en-dim128/1'</code></em>)</p>
</blockquote>
<p>Call the text embedding from the TF-Hub library</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the embedded text feature column. If it's called it for the first time, it may take time to download it (it weights around 500 MB)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">embedded_text_feature_column</span> <span class="o">=</span> <span class="n">embedded_text_feature_column_f</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Premade Estimators</em></strong></p>
<p>For classification, we use a premade <a href="https://www.tensorflow.org/api_docs/python/tf/estimator/DNNClassifier">DNN Classifier</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_estimator" class="doc_header"><code>load_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L76" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_estimator</code>(<strong><code>embedded_text_feature_column</code></strong>, <strong><code>estimator_f</code></strong>=<em><code>'DNNClassifierV2'</code></em>, <strong><code>model_dir</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Load the TF <code>estimator</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">estimator</span> <span class="o">=</span> <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When no <em>model_dir</em> is provided, the <code>estimator</code> is stored in a temporary file. A deletion of an  <code>estimator</code> (either explicit or by the garbage collector) does not erase its corresponding directory from the disk</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model_dir</span> <span class="o">=</span> <span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>
<span class="k">del</span> <span class="n">estimator</span> 
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">rmtree</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">estimator</span> <span class="o">=</span> <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train,-Evaluate-and-Predict">Train, Evaluate and Predict<a class="anchor-link" href="#Train,-Evaluate-and-Predict"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Train the estimator for a reasonable amount of steps.<br>
Training for 5,000 steps means 640,000 training examples with the default
batch size (128).<br>
This is roughly equivalent to 640,000/363 ~ 1700 epochs since the training dataset
contains 363 examples.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="train" class="doc_header"><code>train</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L90" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>train</code>(<strong><code>estimator</code></strong>, <strong><code>train_input_fn</code></strong>, <strong><code>steps</code></strong>=<em><code>5000</code></em>)</p>
</blockquote>
<p>Train with TF <code>estimator.train</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">train_input_fn</span><span class="p">,</span><span class="n">steps</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;train&#39;: &lt;tensorflow_estimator.python.estimator.canned.dnn.DNNClassifierV2 at 0x7f588049a290&gt;}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The F1 score is not included in <code>tf.estimator.evaluate</code>. The function <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a>, calculates the F1 score from the precision and recall. The function <a href="/job_offer_classifier/multiclass#evaluate"><code>evaluate</code></a> adds to  <code>tf.estimator.evaluate</code> the  <a href="/job_offer_classifier/pipeline_classifier#f1_score"><code>f1_score</code></a> and is acting over the input functions.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="f1_score" class="doc_header"><code>f1_score</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L99" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>f1_score</code>(<strong><code>estimations</code></strong>)</p>
</blockquote>
<p>Calculates function:</p>
<p><em>f1_score(precision,recall) =  (2 x precision x recall) / (precision + recall)</em></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">f1_score</span><span class="p">({</span><span class="s1">&#39;precision&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">),</span><span class="s1">&#39;recall&#39;</span><span class="p">:</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">13</span><span class="p">)})</span> <span class="o">==</span> <span class="mf">0.0</span>

<span class="k">assert</span> <span class="n">f1_score</span><span class="p">({</span><span class="s1">&#39;precision&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;recall&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">})</span>  <span class="o">==</span> <span class="mf">1.</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="evaluate" class="doc_header"><code>evaluate</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L111" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>evaluate</code>(<strong><code>estimator</code></strong>, <strong>**<code>args</code></strong>:<a href="/job_offer_classifier/multiclass#tf_input_fn"><code>tf_input_fn</code></a>)</p>
</blockquote>
<p>Evaluate with TF <code>estimator.evaluate</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="predict" class="doc_header"><code>predict</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L121" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>predict</code>(<strong><code>estimator</code></strong>, <strong><code>df_examples</code></strong>)</p>
</blockquote>
<p>Predict with TF <code>estimator.predict</code> and from a dataframe of payloads.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Evaluate:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">eval_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="o">**</span><span class="n">predict_input_fn</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Training set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Test set accuracy: </span><span class="si">{accuracy}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">eval_results</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set accuracy: 0.9908257126808167
Test set accuracy: 0.9448275566101074
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span> 
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 0, 1, 1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is desirable a predictor that inputs from a string. The function <a href="/job_offer_classifier/multiclass#sentiment"><code>sentiment</code></a> covers this role.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sentiment" class="doc_header"><code>sentiment</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L138" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sentiment</code>(<strong><code>estimator</code></strong>, <strong><code>doc</code></strong>)</p>
</blockquote>
<p>Gets the sentiment of the <em>doc</em> string</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39; thank you for offering me the position of Merchandiser with Thomas Ltd.</span>
<span class="s1">i am thankful to accept this job offer and look ahead to starting my career with your company</span>
<span class="s1">on June 27, 2000.&#39;&#39;&#39;</span>
<span class="n">sentiment</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span><span class="n">example_str</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;positive&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong><em>Confusion matrix</em></strong><br>
The function <a href="/job_offer_classifier/multiclass#plot_confusion_matrix"><code>plot_confusion_matrix</code></a> plots the corresponding confusion matrix over a dataframe and its corresponding Tensorflow function. The confusion matrix helps  to understand the distribution of misclassifications.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_confusion_matrix" class="doc_header"><code>plot_confusion_matrix</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L146" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_confusion_matrix</code>(<strong><code>df_data</code></strong>, <strong><code>estimator</code></strong>, <strong><code>input_fn</code></strong>, <strong><code>header</code></strong>, <strong><code>fig_file</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Plot the Confusion Matrix: ${{TN,FN},{FP,TP}}$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix for the train set case</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Train data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Confusion Matrix for the test case</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">estimator</span><span class="p">,</span><span class="n">predict_input_fn</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">],</span><span class="n">header</span><span class="o">=</span><span class="s1">&#39;Test data&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Save-and-Load-an-Estimator">Save and Load an Estimator<a class="anchor-link" href="#Save-and-Load-an-Estimator"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The  <a href="/job_offer_classifier/multiclass#export_estimator"><code>export_estimator</code></a> function copy the directory of the estimador given in <code>estimator.model_dir</code> to a <em>dst_model</em>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="export_estimator" class="doc_header"><code>export_estimator</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L171" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>export_estimator</code>(<strong><code>estimator</code></strong>, <strong><code>dst_estimator</code></strong>)</p>
</blockquote>
<p>Copy the estimator's directory to a new directory</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Load the saved estimator using <code>load_model</code> and check that the evaluation results are up to date with latest check point:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">export_estimator</span><span class="p">(</span><span class="n">estimator</span><span class="p">,</span> <span class="n">dst_estimator</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="n">loaded_estimator_results</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span>
        <span class="n">load_estimator</span><span class="p">(</span><span class="n">embedded_text_feature_column</span><span class="p">,</span> <span class="n">model_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">),</span>
        <span class="o">**</span><span class="n">predict_input_fn</span>
    <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">loaded_estimator_results</span> <span class="o">==</span> <span class="n">eval_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Erase all the variables defined so far</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">df</span><span class="p">,</span><span class="n">dfs</span><span class="p">,</span> <span class="n">eval_results</span><span class="p">,</span> <span class="n">embedded_text_feature_column</span><span class="p">,</span> <span class="n">loaded_estimator_results</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;hola this is an string&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;hola this is an string&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Pipeline" class="doc_header"><code>class</code> <code>Pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L177" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Pipeline</code>(<strong><code>src_file</code></strong>=<em><code>None</code></em>, <strong><code>estimator_dir</code></strong>=<em><code>None</code></em>, <strong><code>frac</code></strong>=<em><code>0.6</code></em>, <strong><code>train_steps</code></strong>=<em><code>5000</code></em>, <strong><code>random_state</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Implements the workflow: Load -&gt; Train -&gt; Evaluate.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Pipeline.__del__" class="doc_header"><code>Pipeline.__del__</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L204" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Pipeline.__del__</code>()</p>
</blockquote>
<p>Removes the <code>estimator</code> and its corresponding directory,
unless the estimator_dir is None.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When an estimator is deleted, the corresponding temporary directory is kept in memory</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span> <span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
<span class="n">model_dir</span>  <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>

<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="k">del</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span>
<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="n">rmtree</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The attribute <code>__del__</code>  in the <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> class fixes this</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
<span class="n">model_dir</span>  <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>

<span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
<span class="k">del</span> <span class="n">pl</span>
<span class="k">assert</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The deletion of the <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> instance does not cause the deletion of the estimator directory when the estimator has been previously loaded (specifying it in <em>estimator_dir</em>).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">()</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
    <span class="n">model_dir</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span>
    <span class="n">pl</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">dst_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">pl</span>
    
    <span class="k">assert</span> <span class="n">tmp_dir</span> <span class="o">!=</span> <span class="n">model_dir</span>
    <span class="k">assert</span> <span class="ow">not</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">model_dir</span><span class="p">)</span> 
    <span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
    <span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">estimator_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="k">del</span> <span class="n">pl</span> 
    
    <span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Does not generate the train TF input function when train dataframe is not provided</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sentiments</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;sentiment&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">sentiment</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]}</span>
<span class="n">df_example_f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sentiment</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">sentiments</span><span class="p">(</span><span class="n">sentiment</span><span class="p">,</span> <span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">),</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">ni</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">nf</span> <span class="o">-</span> <span class="n">ni</span><span class="p">)</span>

<span class="n">pl</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
<span class="n">pl</span><span class="o">.</span><span class="n">dfs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;test&#39;</span><span class="p">:</span> <span class="n">df_example_f</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)}</span> <span class="c1">#no tes</span>
<span class="n">pl</span><span class="o">.</span><span class="n">input_fns</span><span class="p">()</span>
<span class="k">assert</span> <span class="s1">&#39;train&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pl</span><span class="o">.</span><span class="n">input</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="k">assert</span> <span class="s1">&#39;test&#39;</span> <span class="ow">in</span> <span class="n">pl</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;predict&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Pipeline.pipeline" class="doc_header"><code>Pipeline.pipeline</code><a href="https://github.com/kikejimenez/job_offer_classifier/tree/master/job_offer_classifier/pipeline_classifier.py#L268" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Pipeline.pipeline</code>()</p>
</blockquote>
<p>The pipeline flow is:
input_fns --&gt; load_estimator --&gt; train --&gt; evaluate</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>pipeline</code> calls the functions that prepares the input data, trains the model and stores the results of the evaluation</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>After running the pipeline, check that all methods are implemented correctly</strong></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span> <span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">)</span>
<span class="n">pipeline</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting evaluation is stored in <code>pipeline.evaluation</code></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>dict_keys([&#39;train&#39;, &#39;test&#39;])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span>    
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;accuracy&#39;: 0.9655172,
 &#39;accuracy_baseline&#39;: 0.8,
 &#39;auc&#39;: 0.9716111,
 &#39;auc_precision_recall&#39;: 0.9852053,
 &#39;average_loss&#39;: 0.11875317,
 &#39;label/mean&#39;: 0.8,
 &#39;loss&#39;: 0.15028334,
 &#39;precision&#39;: 0.974359,
 &#39;prediction/mean&#39;: 0.7905246,
 &#39;recall&#39;: 0.98275864,
 &#39;global_step&#39;: 5000,
 &#39;f1_score&#39;: 0.9785408132933391}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confusion matrix for train set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confustion matrix for test set</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check save file option in plot confusion matrix</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_file</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span><span class="s1">&#39;tmp.png&#39;</span><span class="p">)</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">,</span><span class="n">fig_file</span><span class="o">=</span><span class="n">tmp_file</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">tmp_file</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Check that the <a href="/job_offer_classifier/multiclass#export_estimator"><code>export_estimator</code></a> is rightly copying the model files</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span><span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pipeline</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span>
    
    <span class="k">assert</span> <span class="n">listdir</span><span class="p">(</span><span class="n">tmp_dir</span><span class="p">)</span> <span class="o">==</span> <span class="n">listdir</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">estimator</span><span class="o">.</span><span class="n">model_dir</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict examples from dataframe in 0 1 format</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([1, 1])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Predict from string</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc_str</span><span class="o">=</span><span class="s1">&#39;&#39;&#39;thank you very much for offering me the opportunity to work at Norris, Wilson and Kelley as Clinical embryologist.</span><span class="se">\n</span><span class="s1">after much deliberation, i will not be accepting the position,</span>
<span class="s1">as it isnt the right fit for my long-term career goals.</span><span class="se">\n</span><span class="s1">i sincerely appreciate the offer and give you</span>
<span class="s1">my best wishes in finding a suitable candidate for the position.</span><span class="se">\n</span><span class="s1">i wish you and the company well </span>
<span class="s1">in all future endeavours.&#39;&#39;&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pipeline</span><span class="o">.</span><span class="n">sentiment</span><span class="p">(</span><span class="n">doc_str</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>negative
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Create an instance of a <a href="/job_offer_classifier/pipeline_classifier#Pipeline"><code>Pipeline</code></a> and run it (call <code>pipeline</code> method). Export the <code>estimator</code>. 
Create a new instance of a <code>pipeline</code> with the exported <code>estimator</code>. Evaluate in this pipeline without training.
The resulting evaluations of the two pipelines must coincide, provided that the <code>evaluation</code> is carried out in the same test set [CAVEAT: They must coincide up to a factor (see below)].</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">random_state</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">**</span><span class="mi">32</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">tmpdirname</span><span class="p">:</span>
    <span class="n">tmp_dir</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmpdirname</span><span class="p">,</span> <span class="s1">&#39;tmp&#39;</span><span class="p">)</span>
    <span class="n">pl1</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">pl1</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
    <span class="n">pl1</span><span class="o">.</span><span class="n">export_estimator</span><span class="p">(</span><span class="n">dst_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">)</span>
    <span class="n">pl2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="n">src_file</span><span class="o">=</span><span class="s1">&#39;../data/interim/payloads.csv&#39;</span><span class="p">,</span><span class="n">estimator_dir</span><span class="o">=</span><span class="n">tmp_dir</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="n">random_state</span><span class="p">)</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">input_fns</span><span class="p">()</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">load_estimator</span><span class="p">()</span>
    <span class="n">pl2</span><span class="o">.</span><span class="n">evaluate</span><span class="p">()</span>
    
<span class="k">assert</span>  <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span> <span class="o">==</span>  <span class="n">pl2</span><span class="o">.</span><span class="n">evaluation</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instantiate the Pipeline class twice with the same seed</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="mi">32</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;src_file&#39;</span><span class="p">:</span> <span class="s1">&#39;../data/interim/payloads.csv&#39;</span>
<span class="p">}</span>
<span class="n">pl1</span><span class="p">,</span> <span class="n">pl2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">),</span> <span class="n">Pipeline</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">pl1</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
<span class="n">pl2</span><span class="o">.</span><span class="n">pipeline</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the seed is the same from both pipelines, the train/test split is the same in both cases</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">pl1</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">pl2</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">((</span><span class="n">pl1</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">==</span><span class="n">pl2</span><span class="o">.</span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Tensorflow training algorithms are not completely <a href="https://github.com/NVIDIA/tensorflow-determinism"><em>deterministic</em></a>. Therefore, the scores in the two pipelines are equal up to a factor. Calculate that factor.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; $error  = m 10^{-n}$</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">all</span><span class="p">(</span>
        <span class="nb">abs</span><span class="p">(</span>
            <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">dataname</span><span class="p">][</span><span class="n">scorename</span><span class="p">]</span> <span class="o">-</span>
            <span class="n">pl2</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="n">dataname</span><span class="p">][</span><span class="n">scorename</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">&lt;</span> <span class="n">m</span> <span class="o">*</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">dataname</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;test&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">scorename</span> <span class="ow">in</span> <span class="n">pl1</span><span class="o">.</span><span class="n">evaluation</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="p">):</span>
    <span class="k">if</span> <span class="n">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="k">break</span>
        
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The scores with different instances of the pipeline class are equal up to a factor of </span><span class="si">{</span><span class="n">m</span><span class="si">}</span><span class="s1"> x 10^(</span><span class="si">{</span><span class="o">-</span><span class="n">n</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span> 

<span class="k">assert</span> <span class="n">is_equal_pipe_evals</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>The scores with different instances of the pipeline class are equal up to a factor of 2 x 10^(-2)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

